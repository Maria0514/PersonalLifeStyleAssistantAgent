# Personal Lifestyle Assistant Agent - API æ¥å£æ–‡æ¡£

## ğŸ“‹ æ¥å£æ¦‚è§ˆ

æœ¬æ–‡æ¡£æè¿°äº†ä¸ªäººç”Ÿæ´»åŠ©ç†Agentçš„å‰åç«¯APIæ¥å£è§„èŒƒã€‚å‰ç«¯Vue3åº”ç”¨é€šè¿‡è¿™äº›æ¥å£ä¸FastAPIåç«¯è¿›è¡Œé€šä¿¡ã€‚

### ğŸ—ï¸ ç³»ç»Ÿæ¶æ„

```
Vue 3 å‰ç«¯ (http://localhost:5173)
    â†• HTTP/JSON
FastAPI åç«¯ (http://localhost:8000)
    â†• 
LangChain Agent + Tools
```

---

## ğŸŒ åŸºç¡€ä¿¡æ¯

- **Base URL**: `http://localhost:8000` (å¼€å‘ç¯å¢ƒ)
- **Content-Type**: `application/json`
- **å“åº”æ ¼å¼**: JSON
- **å­—ç¬¦ç¼–ç **: UTF-8

---

## ğŸ“¡ API æ¥å£åˆ—è¡¨

### 1. å‘é€æ¶ˆæ¯æ¥å£

ä¸AIåŠ©ç†è¿›è¡Œå¯¹è¯çš„æ ¸å¿ƒæ¥å£ã€‚

**æ¥å£åœ°å€**: `POST /message`

**è¯·æ±‚å‚æ•°**:
```json
{
  "message": "string",      // ç”¨æˆ·è¾“å…¥çš„æ¶ˆæ¯å†…å®¹
  "timestamp": "string"     // ISO 8601æ ¼å¼çš„æ—¶é—´æˆ³ (å¯é€‰)
}
```

**è¯·æ±‚ç¤ºä¾‹**:
```json
{
  "message": "ä»Šå¤©çš„å¤©æ°”æ€ä¹ˆæ ·ï¼Ÿ",
  "timestamp": "2025-08-13T12:30:00.000Z"
}
```

**å“åº”æ ¼å¼**:
```json
{
  "message": "string",      // AIåŠ©ç†çš„å›å¤å†…å®¹
  "success": true,          // è¯·æ±‚æ˜¯å¦æˆåŠŸ
  "tool_used": "string",    // ä½¿ç”¨çš„å·¥å…·ID (å¯é€‰)
  "metadata": {             // å…ƒæ•°æ® (å¯é€‰)
    "tokens_used": 150,
    "response_time": 1.23,
  }
}
```

**æˆåŠŸå“åº”ç¤ºä¾‹**:
```json
{
  "message": "ä»Šå¤©åŒ—äº¬å¤©æ°”æ™´æœ—ï¼Œæ°”æ¸©23Â°Cï¼Œé€‚åˆå¤–å‡ºæ´»åŠ¨ã€‚å»ºè®®æ‚¨ç©¿ç€èˆ’é€‚çš„æ˜¥ç§‹è£…ã€‚",
  "success": true,
  "tool_used": "search",
  "metadata": {
    "tokens_used": 45,
    "response_time": 0.85,
  }
}
```

**é”™è¯¯å“åº”ç¤ºä¾‹**:
```json
{
  "message": "æŠ±æ­‰ï¼Œæˆ‘ç°åœ¨æ— æ³•å¤„ç†æ‚¨çš„è¯·æ±‚ï¼Œè¯·ç¨åå†è¯•ã€‚",
  "success": false,
  "error": "Internal server error",
  "error_code": "SERVER_ERROR"
}
```

**çŠ¶æ€ç **:
- `200`: æˆåŠŸ
- `400`: è¯·æ±‚å‚æ•°é”™è¯¯
- `429`: è¯·æ±‚é¢‘ç‡è¿‡é«˜
- `500`: æœåŠ¡å™¨å†…éƒ¨é”™è¯¯

---

### 2. å¥åº·æ£€æŸ¥æ¥å£

æ£€æŸ¥æœåŠ¡å™¨è¿è¡ŒçŠ¶æ€å’Œå„ç»„ä»¶å¥åº·çŠ¶å†µã€‚

**æ¥å£åœ°å€**: `GET /health`

**è¯·æ±‚å‚æ•°**: æ— 

**å“åº”æ ¼å¼**:
```json
{
  "status": "string",       // æœåŠ¡çŠ¶æ€: "healthy" | "degraded" | "unhealthy"
  "timestamp": "string",    // æ£€æŸ¥æ—¶é—´æˆ³
  "version": "string",      // æœåŠ¡ç‰ˆæœ¬
  "components": {           // å„ç»„ä»¶çŠ¶æ€
    "database": "healthy",
    "langchain": "healthy",
    "tools": {
      "search": "healthy",
      "calculator": "healthy",
      "memory": "healthy",
      "reminder": "healthy"
    }
  },
  "uptime": 3600           // æœåŠ¡è¿è¡Œæ—¶é—´(ç§’)
}
```

**å“åº”ç¤ºä¾‹**:
```json
{
  "status": "healthy",
  "timestamp": "2025-08-13T12:30:00.000Z",
  "version": "1.0.0",
  "components": {
    "database": "healthy",
    "langchain": "healthy",
    "tools": {
      "search": "healthy",
      "calculator": "healthy", 
      "memory": "healthy",
      "reminder": "healthy"
    }
  },
  "uptime": 3600
}
```

**çŠ¶æ€ç **:
- `200`: æœåŠ¡å¥åº·
- `503`: æœåŠ¡ä¸å¯ç”¨

---

### 3. è·å–å¯¹è¯å†å²æ¥å£ (è§„åˆ’ä¸­)

è·å–ç”¨æˆ·çš„å†å²å¯¹è¯è®°å½•ã€‚

**æ¥å£åœ°å€**: `GET /conversations`

**è¯·æ±‚å‚æ•°**:
- `limit`: è¿”å›è®°å½•æ•°é‡ (å¯é€‰ï¼Œé»˜è®¤20)
- `offset`: åˆ†é¡µåç§»é‡ (å¯é€‰ï¼Œé»˜è®¤0)
- `session_id`: ä¼šè¯ID (å¯é€‰)

**å“åº”æ ¼å¼**:
```json
{
  "conversations": [
    {
      "id": "string",
      "user_message": "string",
      "bot_response": "string", 
      "timestamp": "string",
      "tool_used": "string"
    }
  ],
  "total": 100,
  "has_more": true
}
```

---

### 4. é‡ç½®å¯¹è¯æ¥å£ (è§„åˆ’ä¸­)

æ¸…é™¤å½“å‰ä¼šè¯çš„è®°å¿†å’Œä¸Šä¸‹æ–‡ã€‚

**æ¥å£åœ°å€**: `POST /reset`

**è¯·æ±‚å‚æ•°**:
```json
{
  "session_id": "string"   // ä¼šè¯ID (å¯é€‰)
}
```

**å“åº”æ ¼å¼**:
```json
{
  "success": true,
  "message": "å¯¹è¯å†å²å·²é‡ç½®"
}
```

---

## ğŸ› ï¸ å·¥å…·ç³»ç»Ÿ

AIåŠ©ç†æ”¯æŒä»¥ä¸‹å·¥å…·ï¼Œä¼šæ ¹æ®ç”¨æˆ·è¾“å…¥è‡ªåŠ¨é€‰æ‹©ä½¿ç”¨ï¼š

### å·¥å…·åˆ—è¡¨

| å·¥å…·ID | å·¥å…·åç§° | åŠŸèƒ½æè¿° | è§¦å‘å…³é”®è¯ |
|--------|----------|----------|------------|
| `search` | ç½‘ç»œæœç´¢ | æœç´¢å®æ—¶ä¿¡æ¯ã€å¤©æ°”æŸ¥è¯¢ | å¤©æ°”ã€æœç´¢ã€æŸ¥è¯¢ |
| `calculator` | è®¡ç®—å™¨ | æ•°å­¦è®¡ç®—å’Œè¡¨è¾¾å¼æ±‚å€¼ | è®¡ç®—ã€æ•°å­—ã€è¿ç®—ç¬¦ |
| `memory` | è®°å¿†ç³»ç»Ÿ | è®°å½•å’Œå›å¿†å¯¹è¯ä¸Šä¸‹æ–‡ | è®°ä½ã€ä¹‹å‰ã€å›å¿† |
| `reminder` | æé†’å·¥å…· | è®¾ç½®æ—¶é—´æé†’å’Œä»»åŠ¡ | æé†’ã€é—¹é’Ÿã€å®šæ—¶ |

### å·¥å…·ä½¿ç”¨æµç¨‹

1. ç”¨æˆ·å‘é€æ¶ˆæ¯
2. Agentåˆ†ææ¶ˆæ¯å†…å®¹
3. é€‰æ‹©åˆé€‚çš„å·¥å…·
4. æ‰§è¡Œå·¥å…·åŠŸèƒ½
5. åŸºäºå·¥å…·ç»“æœç”Ÿæˆå›å¤

---

## ğŸ”§ å‰ç«¯é›†æˆè¯´æ˜

### ç¯å¢ƒé…ç½®

å‰ç«¯é€šè¿‡ç¯å¢ƒå˜é‡é…ç½®APIåœ°å€ï¼š

```bash
# .env
VITE_API_BASE_URL=http://localhost:8000
```

### é”™è¯¯å¤„ç†

å‰ç«¯å…·å¤‡å®Œå–„çš„é”™è¯¯å¤„ç†æœºåˆ¶ï¼š

1. **ç½‘ç»œé”™è¯¯**: è‡ªåŠ¨é‡è¯•æœºåˆ¶
2. **æœåŠ¡å™¨é”™è¯¯**: æ˜¾ç¤ºå‹å¥½é”™è¯¯ä¿¡æ¯
3. **è¶…æ—¶å¤„ç†**: è®¾ç½®åˆç†çš„è¯·æ±‚è¶…æ—¶æ—¶é—´
4. **é™çº§å¤„ç†**: å¼€å‘ç¯å¢ƒæä¾›æ¨¡æ‹Ÿå“åº”

### æ¨¡æ‹Ÿæ¨¡å¼

å¼€å‘ç¯å¢ƒä¸‹ï¼Œå¦‚æœåç«¯æœåŠ¡ä¸å¯ç”¨ï¼Œå‰ç«¯ä¼šä½¿ç”¨å†…ç½®çš„æ¨¡æ‹Ÿå“åº”ï¼š

- **å¤©æ°”æŸ¥è¯¢**: è¿”å›æ¨¡æ‹Ÿå¤©æ°”ä¿¡æ¯
- **æ•°å­¦è®¡ç®—**: æ‰§è¡Œç®€å•çš„æ•°å­¦è¿ç®—
- **è®°è´¦å»ºè®®**: æä¾›é¢„è®¾çš„ç†è´¢å»ºè®®
- **é»˜è®¤å›å¤**: é€šç”¨çš„åŠ©ç†å›å¤

---

## ğŸš€ åç«¯å®ç°æŒ‡å—

### æŠ€æœ¯æ ˆ

- **æ¡†æ¶**: FastAPI
- **AIæ¡†æ¶**: LangChain
- **å·¥å…·**: è‡ªå®šä¹‰Toolå®ç°
- **éƒ¨ç½²**: Uvicorn

### æœ€å°å®ç°

```python
from fastapi import FastAPI
from fastapi.middleware.cors import CORSMiddleware
from pydantic import BaseModel

app = FastAPI(title="Personal Lifestyle Assistant")

# CORSé…ç½®
app.add_middleware(
    CORSMiddleware,
    allow_origins=["http://localhost:5173"],
    allow_credentials=True,
    allow_methods=["*"],
    allow_headers=["*"],
)

class MessageRequest(BaseModel):
    message: str
    timestamp: str = None

class MessageResponse(BaseModel):
    message: str
    success: bool = True
    tool_used: str = None

@app.post("/message", response_model=MessageResponse)
async def send_message(request: MessageRequest):
    # TODO: é›†æˆLangChain Agent
    return MessageResponse(
        message="è¿™æ˜¯æ¥è‡ªåç«¯çš„å›å¤",
        success=True
    )

@app.get("/health")
async def health_check():
    return {"status": "healthy", "version": "1.0.0"}
```

---

## ğŸ“Š æ€§èƒ½æŒ‡æ ‡

### æœŸæœ›æ€§èƒ½

- **å“åº”æ—¶é—´**: < 2ç§’ (95%çš„è¯·æ±‚)
- **ååé‡**: > 100 è¯·æ±‚/åˆ†é’Ÿ
- **å¯ç”¨æ€§**: > 99.9%
- **å¹¶å‘æ”¯æŒ**: 50+ å¹¶å‘ç”¨æˆ·

### ç›‘æ§æŒ‡æ ‡

- APIå“åº”æ—¶é—´
- é”™è¯¯ç‡
- å·¥å…·è°ƒç”¨æˆåŠŸç‡
- å†…å­˜å’ŒCPUä½¿ç”¨ç‡

---

## ğŸ”’ å®‰å…¨è€ƒè™‘

### å½“å‰å®ç°

- CORSé…ç½®é™åˆ¶å‰ç«¯è®¿é—®
- è¾“å…¥éªŒè¯å’Œæ¸…ç†
- é”™è¯¯ä¿¡æ¯ä¸æš´éœ²æ•æ„Ÿä¿¡æ¯

### æœªæ¥å¢å¼º

- APIå¯†é’¥è®¤è¯
- è¯·æ±‚é¢‘ç‡é™åˆ¶
- è¾“å…¥å†…å®¹è¿‡æ»¤
- å®¡è®¡æ—¥å¿—è®°å½•

---

## ğŸ“ æ›´æ–°æ—¥å¿—

### v1.0.0 (2025-08-13)
- å®šä¹‰åŸºç¡€APIæ¥å£è§„èŒƒ
- å®ç°å‰ç«¯æ¨¡æ‹Ÿå“åº”æœºåˆ¶
- è®¾è®¡å·¥å…·ç³»ç»Ÿæ¶æ„

### æœªæ¥ç‰ˆæœ¬è®¡åˆ’
- v1.1.0: ç”¨æˆ·è®¤è¯ç³»ç»Ÿ
- v1.2.0: å¯¹è¯å†å²ç®¡ç†
- v1.3.0: é«˜çº§å·¥å…·é›†æˆ
- v2.0.0: å¤šç”¨æˆ·æ”¯æŒ

---

## ğŸ¤ è”ç³»æ–¹å¼

å¦‚æœ‰APIç›¸å…³é—®é¢˜ï¼Œè¯·é€šè¿‡ä»¥ä¸‹æ–¹å¼è”ç³»ï¼š
- æäº¤ GitHub Issue
- æŸ¥çœ‹é¡¹ç›®æ–‡æ¡£
- å‚ä¸é¡¹ç›®è®¨è®º

---

*æœ¬æ–‡æ¡£éšé¡¹ç›®å¼€å‘è¿›åº¦æŒç»­æ›´æ–°*
